<div style="text-align:center">
<img src="https://i.imgur.com/WnzSYgA.png" width="150" align="center"></img>
</div>

# Mantis Reporter
Инструмент, позволяющий пользователям анонимно отправлять баг-репорты в систему баг-трекинга Mantis.
Использует Soap API.

## Ключевые особенности
 * Простой интерфейс с минимумом полей, понятный конечному пользователю.
 * Не требует подключения к БД (запросы обратываются через API).
 * Возможно использование Google ReCaptcha для защиты от спама.
 * Автоматическое определение локали сервера и выбор пакета локализации (при его наличии).

### Скриншоты
#### Общий вид
![MainPage](https://i.imgur.com/zKTrss6.png)

#### Основная форма
![MainForm](https://i.imgur.com/iqtqC5p.png)

#### Информация о скрипте
![AboutPage](https://i.imgur.com/lnEHwZR.png)

## Системные требования
 * PHP 7.0+ (ранние версии не тестировались)
   * Параметры php
     * allow_url_fopen = On
   * Расширения php
     * intl (с корректно настроенной локалью)
     * SOAP

## Установка
 * Разместите файлы в директории веб-сервера.
 * Укажите логин и пароль от учетной записи Mantis в файле `conf/conf.php`.
 * Заполните прочие параметры в переменных, находящихся в файле настроек `conf/conf.php`. (Подробнее см. в разделе "Настройка скрипта").

_Для работы скрипта требуется учетная запись от Mantis с уровнем доступа "**автор**" и выше. Рекомендуется создать отдельную учетную запись для скрипта._

## Настройка
#### Настройка Mantis
 * Создайте отдельного пользователя с уровнем доступа не ниже "**автор**".
 * Добавьте созданного пользователя к тем проектам, по которым должен осуществляться сбор заявок через форму "Mantis Reporter".

#### Настройки скрипта
**Описание переменных в файле настроек `conf/conf.php`**
 * **MAIN_TITLE** - _(по-умолчанию: "Mantis Reporter")_ - Заголовок страницы (название сайта)
 * **FORCE_LOCALE** - _(Значения: "0" или "1". По-умолчанию: "0")_ - Принудительное определение локали (подробнее см. в разделе "Локализация")
 * **USERNAME** - Логин пользователя, от которого будут создаваться задачи
 * **PASSWORD** - Пароль пользователя
 * **USERID** - ID пользователя от которого будут создаваться задачи
 * **MANTISURL** - URL mantis для подстановки в ссылку для перехода
 * **WSDL_POINT** - URL до API mantis (https://%MANTIS_URL%/api/soap/mantisconnect.php?wsdl)
 * **PROJECT_ID** - ID проекта из которого будет взят список типов задач. (Временное решение)
 * **USECAPTCHA** - _(Значения: "0" или "1". По-умолчанию: "0")_ - Включить/отключить использование Google ReCaptcha.
 * **CAPTCHA_SITEKEY** - Ключ сайта Google ReCaptcha.
 * **CAPTCHA_SECRET** - Secret Key Google ReCaptcha.

## Локализация
Скрипт пытается определить локаль, заданную в php_intl, а затем, найти соответствующий файл локализации в директории **L10n**

Локаль можно выставить принудительно в файле `system.conf.php` в переменной **$FORCE_LOCALE**.
Значение по-умолчанию - `$FORCE_LOCALE="0"`. Это означает, что скрипт будет пытаться определить локаль.
В случае, если определенная локаль не соответствует имеющимся локалям, будет выставлена локаль по-умолчанию *(на данный момент ru_RU)*
